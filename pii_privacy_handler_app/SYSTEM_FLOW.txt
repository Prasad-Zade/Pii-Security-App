================================================================================
                    PII PRIVACY HANDLER - SYSTEM FLOW
================================================================================

                            HOW IT WORKS
                            
┌─────────────────────────────────────────────────────────────────────────┐
│                         USER INPUT (Flutter App)                        │
│  "My name is John Smith and my phone is 7418529635. Calculate sum."    │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                    STEP 1: PII DETECTION (Dart)                         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │ Detected:                                                        │  │
│  │  - Name: "John Smith"                                            │  │
│  │  - Phone: "7418529635"                                           │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                  STEP 2: DEPENDENCY ANALYSIS (Dart)                     │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │ Keywords found: "Calculate", "sum"                               │  │
│  │                                                                  │  │
│  │ Analysis:                                                        │  │
│  │  - Name: NON-DEPENDENT (not needed for calculation)             │  │
│  │  - Phone: DEPENDENT (needed for sum calculation)                │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                    STEP 3: SELECTIVE MASKING (Dart)                     │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │ Masked Query:                                                    │  │
│  │ "My name is Mike and my phone is 7418529635. Calculate sum."    │  │
│  │              ↑ Fake name         ↑ Original phone kept          │  │
│  │                                                                  │  │
│  │ Replacements: {"Mike" → "John Smith"}                           │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                  STEP 4: SEND TO BACKEND (HTTP)                         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │ POST http://localhost:5000/api/sessions/{id}/messages           │  │
│  │                                                                  │  │
│  │ Body: {                                                          │  │
│  │   "text": "My name is Mike and my phone is 7418529635..."       │  │
│  │   "pii_analysis": { ... }                                        │  │
│  │ }                                                                │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                  STEP 5: BACKEND PROCESSING (Python)                    │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │ 1. Receive masked query                                         │  │
│  │ 2. Send to Gemini LLM API                                       │  │
│  │ 3. Get response: "The sum of digits in 7418529635 is 44"       │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                  STEP 6: RESPONSE RECONSTRUCTION (Python)               │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │ Replace fake data with original PII:                            │  │
│  │  "Mike" → "John Smith"                                           │  │
│  │                                                                  │  │
│  │ Final Response:                                                  │  │
│  │ "The sum of digits in 7418529635 is 44"                         │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                    STEP 7: DISPLAY TO USER (Flutter)                    │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │ User sees:                                                       │  │
│  │ "The sum of digits in 7418529635 is 44"                         │  │
│  │                                                                  │  │
│  │ Privacy Score: 50% (1 of 2 PII items masked)                    │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────┘

================================================================================
                          PRIVACY PROTECTION
================================================================================

WHAT GETS MASKED:
-----------------
✅ Names (when not needed for computation)
✅ Phone numbers (when not needed for computation)
✅ Email addresses
✅ Detailed addresses
✅ SSN, Credit cards, etc.

WHAT GETS PRESERVED:
--------------------
✅ Phone numbers (when needed for calculation)
✅ Numbers (when computation keywords detected)
✅ Place names (cities, countries)
✅ General information

COMPUTATION KEYWORDS:
---------------------
add, addition, sum, calculate, multiply, divide, subtract,
total, count, average, mean, percentage, compute, math,
arithmetic, operation, result, answer, solve

================================================================================
                          CURRENT STATUS
================================================================================

✅ PII Detection:        WORKING (9/10 tests passing)
✅ Dependency Analysis:  WORKING (correctly identifies dependencies)
✅ Selective Masking:    WORKING (masks appropriately)
✅ Fake Data Generation: WORKING (generates realistic replacements)
✅ Privacy Scoring:      WORKING (calculates correctly)

❌ Backend Connection:   NOT WORKING (server not running)

SOLUTION: Start the backend server!
→ Run: START_HERE.bat
→ Or: cd backend && python app.py

================================================================================
                          ARCHITECTURE
================================================================================

┌─────────────────┐
│  Flutter App    │  ← User Interface
│  (Dart)         │
└────────┬────────┘
         │ HTTP
         ▼
┌─────────────────┐
│  Flask Backend  │  ← API Server (Port 5000)
│  (Python)       │
└────────┬────────┘
         │
         ├─→ PII Dependency Handler (Python)
         │   └─→ Detects & Analyzes PII
         │
         ├─→ Model Wrapper (Python)
         │   └─→ Processes queries
         │
         └─→ Gemini LLM API
             └─→ Generates responses

================================================================================
                          FILE STRUCTURE
================================================================================

pii_privacy_handler_app/
│
├── lib/
│   └── services/
│       └── pii_dependency_analyzer.dart  ← PII Detection (Dart)
│
├── backend/
│   ├── app.py                            ← Flask Server
│   ├── model_wrapper.py                  ← Model Integration
│   ├── pii_dependency_handler.py         ← PII Processing
│   ├── test_simple.py                    ← Connection Test
│   └── requirements.txt                  ← Dependencies
│
├── comprehensive_test.dart               ← Test Suite
├── START_HERE.bat                        ← Main Startup Script
└── README_QUICK_START.md                 ← Documentation

================================================================================
                          QUICK START
================================================================================

1. Double-click: START_HERE.bat
2. Wait for: "Running on http://0.0.0.0:5000"
3. Keep window open
4. Run Flutter app
5. Test with PII messages

================================================================================
